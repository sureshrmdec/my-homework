<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="3.6 'inet_aton', 'inet_addr', and 'inet_ntoa' Functions"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131411551_ch03lev1sec5.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131411551_ch03lev1sec7.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch03lev1sec6"></A>
<H3 class="docSection1Title">3.6 <TT>inet_aton</TT>, <TT>inet_addr</TT>, and <TT>inet_ntoa</TT> Functions</H3>
<P class="docText">We will describe two groups of address conversion functions in this section and the next. They convert Internet addresses between ASCII strings (what humans prefer to use) and network byte ordered binary values (values that are stored in socket address structures).</P>
<span style="font-weight:bold"><OL class="docList" TYPE="1"><LI><span style="font-weight:normal"><P class="docList"><TT>inet_aton</TT>, <TT>inet_ntoa</TT>, and <TT>inet_addr</TT> convert an IPv4 address from a dotted-decimal string (e.g., <TT>"206.168.112.96"</TT>) to its 32-bit network byte ordered binary value. You will probably encounter these functions in lots of existing code.</P></span></LI><LI><span style="font-weight:normal"><P class="docList">The newer functions, <TT>inet_pton</TT> and <TT>inet_ntop</TT>, handle both IPv4 and IPv6 addresses. We describe these two functions in the next section and use them throughout the text.</P></span></LI></OL></span>
<P><TABLE CELLSPACING="0" BORDER="1" RULES="none" CELLPADDING="5" WIDTH="100%"><COLGROUP align="left" span="1"><THEAD></THEAD><TR><TD class="docTableCell" valign="top"><P class="docText"><TT>#include &lt;arpa/inet.h&gt;</TT></P></TD></TR><TR><TD class="docTableCell" valign="top"><P class="docText"><TT>int inet_aton(const char *</TT><span class="docEmphasis">strptr</span>, <TT>struct in_addr *</TT><span class="docEmphasis">addrptr</span><TT>);</TT></P></TD></TR><TR><TD class="docTableCell" align="right" valign="top"><P class="docText">Returns: 1 if string was valid, 0 on error</P></TD></TR><TR><TD class="docTableCell" valign="top"><P class="docText"><TT>in_addr_t inet_addr(const char *</TT><span class="docEmphasis">strptr</span><TT>);</TT></P></TD></TR><TR><TD class="docTableCell" align="right" valign="top"><P class="docText">Returns: 32-bit binary network byte ordered IPv4 address; <TT>INADDR_NONE</TT> if error</P></TD></TR><TR><TD class="docTableCell" valign="top"><P class="docText"><TT>char *inet_ntoa(struct in_addr</TT> <span class="docEmphasis">inaddr</span><TT>);</TT></P></TD></TR><TR><TD class="docTableCell" align="right" valign="top"><P class="docText">Returns: pointer to dotted-decimal string</P></TD></TR></COLGROUP></TABLE></P>
<P class="docText">The first of these, <TT>inet_aton</TT>, converts the C character string pointed to by <span class="docEmphasis">strptr</span> into its 32-bit binary network byte ordered value, which is stored through the pointer <span class="docEmphasis">addrptr</span>. If successful, 1 is returned; otherwise, 0 is returned.</P>
<BLOCKQUOTE><P><P class="docList">An undocumented feature of <TT>inet_aton</TT> is that if <span class="docEmphasis">addrptr</span> is a null pointer, the function still performs its validation of the input string but does not store any result.</P></P></BLOCKQUOTE>
<P class="docText"><TT>inet_addr</TT> does the same conversion, returning the 32-bit binary network byte ordered value as the return value. The problem with this function is that all 2<SUP>32</SUP> possible binary values are valid IP addresses (0.0.0.0 through 255.255.255.255), but the function returns the constant <TT>INADDR_NONE</TT> (typically 32 one-bits) on an error. This means the dotted-decimal string 255.255.255.255 (the IPv4 limited broadcast address, <A class="docLink" HREF="0131411551_ch20lev1sec2.html#ch20lev1sec2">Section 20.2</A>) cannot be handled by this function since its binary value appears to indicate failure of the function.</P>
<BLOCKQUOTE><P><P class="docList">A potential problem with <TT>inet_addr</TT> is that some man pages state that it returns –1 on an error, instead of <TT>INADDR_NONE</TT>. This can lead to problems, depending on the C compiler, when comparing the return value of the function (an unsigned value) to a negative constant.</P></P></BLOCKQUOTE>
<P class="docText">Today, <TT>inet_addr</TT> is deprecated and any new code should use <TT>inet_aton</TT> instead. Better still is to use the newer functions described in the next section, which handle both IPv4 and IPv6.</P>
<P class="docText">The <TT>inet_ntoa</TT> function converts a 32-bit binary network byte ordered IPv4 address into its corresponding dotted-decimal string. The string pointed to by the return value of the function resides in static memory. This means the function is not reentrant, which we will discuss in <A class="docLink" HREF="0131411551_ch11lev1sec18.html#ch11lev1sec18">Section 11.18</A>. Finally, notice that this function takes a structure as its argument, not a pointer to a structure.</P>
<BLOCKQUOTE><P><P class="docList">Functions that take actual structures as arguments are rare. It is more common to pass a pointer to the structure.</P></P></BLOCKQUOTE>

<ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131411551_ch03lev1sec5.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131411551_ch03lev1sec7.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
