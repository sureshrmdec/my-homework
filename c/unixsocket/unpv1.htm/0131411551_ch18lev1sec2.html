<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="18.2 Datalink Socket Address Structure"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131411551_ch18lev1sec1.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131411551_ch18lev1sec3.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch18lev1sec2"></A>
<H3 class="docSection1Title">18.2 Datalink Socket Address Structure</H3>
<P class="docText">We will encounter datalink socket address structures as return values contained in some of the messages returned on a routing socket. <A class="docLink" HREF="#ch18fig01">Figure 18.1</A> shows the definition of the structure, which is defined by including <TT>&lt;net/if_dl.h&gt;</TT>.</P>

<H5 class="docExampleTitle"><A NAME="ch18fig01"></A>Figure 18.1 Datalink socket address structure.</H5>

<PRE>
struct sockaddr_dl {
  uint8_t      sdl_len;
  sa_family_t  sdl_family;   /* AF_LINK */
  uint16_t     sdl_index;    /* system assigned index, if &gt; 0 */
  uint8_t      sdl_type;     /* IFT_ETHER, etc. from &lt;net/if_types.h&gt; */
  uint8_t      sdl_nlen;     /* name length, starting in sdl_data[0] */
  uint8_t      sdl_alen;     /* link-layer address length */
  uint8_t      sdl_slen;     /* link-layer selector length */
  char         sdl_data[12]; /* minimum work area, can be larger;
                                contains i/f name and link-layer address */
};
</PRE>

<P class="docText">Each interface has a unique positive index, and we will see this returned by the <TT>if_nametoindex</TT> and <TT>if_nameindex</TT> functions later in this chapter, along with the IPv6 multicasting socket options in <A class="docLink" HREF="0131411551_ch21.html#ch21">Chapter 21</A> and some advanced IPv4 and IPv6 socket options in <A class="docLink" HREF="0131411551_ch27.html#ch27">Chapter 27</A>.</P>
<P class="docText">The <TT>sdl_data</TT> member contains both the name and link-layer address (e.g., the 48-bit MAC address for an Ethernet interface). The name begins at <TT>sdl_data[0]</TT> and is not null-terminated. The link-layer address begins <TT>sdl_nlen</TT> bytes after the name. This header defines the following macro to return the pointer to the link-layer address:</P>
<pre>

</pre><pre>
#define LLADDR(s)     ((caddr_t)((s)-&gt;sdl_data + (s)-&gt;sdl_nlen))
</pre><pre>
</pre>
<P class="docText">These socket address structures are variable-length (p. 89 of TCPv2). If the link-layer address and name exceed 12 bytes, the structure will be larger than 20 bytes. The size is normally rounded up to the next multiple of 4 bytes on 32-bit systems. We will also see in <A class="docLink" HREF="0131411551_ch22lev1sec2.html#ch22fig03">Figure 22.3</A> that when one of these structures is returned by the <TT>IP_RECVIF</TT> socket option, all three lengths are 0 and there is no <TT>sdl_data</TT> member at all.</P>

<ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131411551_ch18lev1sec1.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131411551_ch18lev1sec3.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
