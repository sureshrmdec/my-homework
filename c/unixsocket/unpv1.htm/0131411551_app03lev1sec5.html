<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="C.5 'tcpdump' Program"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131411551_app03lev1sec4.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131411551_app03lev1sec6.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="app03lev1sec5"></A>
<H3 class="docSection1Title">C.5 <TT>tcpdump</TT> Program</H3>
<P class="docText">An invaluable tool when dealing with network programming is a tool like <TT>tcpdump</TT>. This program reads packets from a network and prints lots of information about the packets. It also has the capability of printing only those packets that match some criteria that we specify. For example,</P>
<pre>

</pre><pre>
% <span class="docEmphStrong">tcpdump '(udp and port daytime) or icmp'</span>
</pre><pre>
</pre>
<P class="docText">prints only the UDP datagrams with a source or destination port of 13 (the daytime server), or ICMP packets. The following command:</P>
<pre>

</pre><pre>
% <span class="docEmphStrong">tcpdump 'tcp and port 80 and tcp[13:1] &amp; 2 != 0'</span>
</pre><pre>
</pre>
<P class="docText">prints only the TCP segments with a source or destination port of 80 (the HTTP server) that have the SYN flag set. The SYN flag has a value of 2 in the byte with an offset of 13 from the start of the TCP header. The following command:</P>
<pre>

</pre><pre>
% <span class="docEmphStrong">tcpdump 'tcp and tcp[0:2] &gt; 7000 and tcp[0:2] &lt;= 7005'</span>
</pre><pre>
</pre>
<P class="docText">prints only TCP segments with a source port between 7001 and 7005. The source port starts at byte offset 0 in the TCP header and occupies 2 bytes.</P>
<P class="docText">Appendix A of TCPv1 details the operation of this program in more detail.</P>
<BLOCKQUOTE><P><P class="docList">This program is available from <A class="docLink" target="_blank" HREF="http://www.tcpdump.org/default.htm">http://www.tcpdump.org/</A> and works under many different flavors of Unix. It was originally written by Van Jacobson, Craig Leres, and Steven McCanne at LBL, and is now maintained by a team at <TT>tcpdump.org</TT>.</P></P><P><P class="docList">Some vendors supply a program of their own with similar functionality. For example, Solaris 2.x provides the <TT>snoop</TT> program. The advantage of <TT>tcpdump</TT> is that it works under so many versions of Unix, and using a single tool in a heterogeneous environment, instead of a different tool for each environment, is a big advantage.</P></P></BLOCKQUOTE>

<a href="0131411551_22961534.html"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131411551_app03lev1sec4.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131411551_app03lev1sec6.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
