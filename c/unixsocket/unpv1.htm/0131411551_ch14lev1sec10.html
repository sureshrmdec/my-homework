<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="14.10 Summary"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131411551_ch14lev1sec9.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131411551_ch14lev1sec11.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="ch14lev1sec10"></A>
<H3 class="docSection1Title">14.10 Summary</H3>
<P class="docText">There are three main ways to set a time limit on a socket operation:</P>
<UL><LI><P class="docList">Use the <TT>alarm</TT> function and the <TT>SIGALRM</TT> signal</P></LI><LI><P class="docList">Use the time limit that is provided by <TT>select</TT></P></LI><LI><P class="docList">Use the newer <TT>SO_RCVTIMEO</TT> and <TT>SO_SNDTIMEO</TT> socket options</P></LI></UL>
<P class="docText">The first is easy to use, but involves signal handling, and as we will see in <A class="docLink" HREF="0131411551_ch20lev1sec5.html#ch20lev1sec5">Section 20.5</A>, can lead to race conditions. Using <TT>select</TT> means that we block in this function with its provided time limit instead of blocking in a call to <TT>read</TT>, <TT>write</TT>, or <TT>connect</TT>. The third alternative, to use the new socket options, is also easy, but is not provided by all implementations.</P>
<P class="docText"><TT>recvmsg</TT> and <TT>sendmsg</TT> are the most general of the five groups of I/O functions provided. They combine the ability to specify an <TT>MSG_</TT><span class="docEmphasis">xxx</span> flag (from <TT>recv</TT> and <TT>send</TT>), plus employ the ability to return or specify the peer's protocol address (from <TT>recvfrom</TT> and <TT>sendto</TT>), with the ability to use multiple buffers (from <TT>readv</TT> and <TT>writev</TT>), along with two new features: returning flags to the application and receiving or sending ancillary data.</P>
<P class="docText">We describe ten different forms of ancillary data in the text, six of which are new with IPv6. Ancillary data consists of one or more ancillary data objects, each object preceded by a <TT>cmsghdr</TT> structure specifying its length, protocol level, and type of data. Five functions beginning with <TT>CMSG_</TT> are used to build and parse ancillary data.</P>
<P class="docText">Sockets can be used with the C standard I/O library, but doing this adds another level of buffering to that already being performed by TCP. Indeed, a lack of understanding of the buffering performed by the standard I/O library is the most common problem with the library. Since a socket is not a terminal device, the common solution to this potential problem is to set the standard I/O stream to unbuffered, or to simply avoid standard I/O on sockets completely.</P>
<P class="docText">Many vendors provide advanced ways to poll for many events without the overhead required by <TT>select</TT> and <TT>poll</TT>. While writing nonportable code should be avoided whenever possible, sometimes the benefits of performance improvements outweigh the risk of nonportability.</P>

<ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131411551_ch14lev1sec9.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131411551_ch14lev1sec11.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
