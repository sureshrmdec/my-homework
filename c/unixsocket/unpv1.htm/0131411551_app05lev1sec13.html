<html><head>
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!--SafClassName="docSection1Title"--><!--SafTocEntry="Chapter 13"-->
<link rel="STYLESHEET" type="text/css" href="FILES/style.css">
<link rel="STYLESHEET" type="text/css" href="FILES/docsafari.css">
<style type="text/css">	.tt1    {font-size: 10pt;}</style>
</head>
<body>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
	<a href="0131411551_app05lev1sec12.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
	<a href="0131411551_app05lev1sec14.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
<br>
<table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top"><A NAME="app05lev1sec13"></A>
<H3 class="docSection1Title"> Chapter 13</H3>
<P><TABLE BORDER="0" cellspacing="16" cellpadding="0"><TR valign="top"><TD align="right" class="docText"><B></B></TD><TD><P class="docText"></P></TD></TR><TR valign="top"><TD align="right" class="docText"><A NAME="ch13a01"></A><B><A class="docLink" HREF="0131411551_ch13lev1sec8.html#ch13q01">13.1</A></B></TD><TD><P class="docText">The startup error due to an invalid command-line argument count would be logged using <TT>syslog</TT></P></TD></TR><TR valign="top"><TD align="right" class="docText"><B></B></TD><TD><P class="docText"></P></TD></TR><TR valign="top"><TD align="right" class="docText"><A NAME="ch13a02"></A><B><A class="docLink" HREF="0131411551_ch13lev1sec8.html#ch13q02">13.2</A></B></TD><TD><P class="docText">The TCP versions of the <TT>echo</TT>, <TT>discard</TT>, and <TT>chargen</TT> servers all run as a child process after being <TT>forked</TT> by <TT>inetd</TT> because these three run until the client terminates the connection. The other two TCP servers, <TT>time</TT> and <TT>daytime</TT>, do not require a <TT>fork</TT> because their service is trivial to implement (get the current time and date, format it, write it, and close the connection), so these two are handled directly by <TT>inetd</TT>. All five UDP services are handled without a <TT>fork</TT> because each generates at most a single datagram in response to the client datagram that triggers the service. These five are therefore handled directly by <TT>inetd</TT>.</P></TD></TR><TR valign="top"><TD align="right" class="docText"><B></B></TD><TD><P class="docText"></P></TD></TR><TR valign="top"><TD align="right" class="docText"><A NAME="ch13a03"></A><B><A class="docLink" HREF="0131411551_ch13lev1sec8.html#ch13q03">13.3</A></B></TD><TD><P class="docText">This is a well-known denial-of-service attack ([CERT 1996a]). The first datagram from port 7 causes the <TT>chargen</TT> server to send a datagram back to port 7. This is echoed and sends another datagram to the <TT>chargen</TT> server. This loop continues. One solution, implemented in FreeBSD, is to refuse datagrams to any of the internal servers if the source port of the incoming datagram belongs to any of the internal servers. Another solution is to disable these internal services, either through <TT>inetd</TT> on each host or at an organization's router to the Internet.</P></TD></TR><TR valign="top"><TD align="right" class="docText"><B></B></TD><TD><P class="docText"></P></TD></TR><TR valign="top"><TD align="right" class="docText"><A NAME="ch13a04"></A><B><A class="docLink" HREF="0131411551_ch13lev1sec8.html#ch13q04">13.4</A></B></TD><TD><P class="docText">The client's IP address and port are obtained from the socket address structure filled in by <TT>accept</TT>.</P><P class="docText">The reason <TT>inetd</TT> does not do this for a UDP socket is because the <TT>recvfrom</TT> to read the datagram is performed by the actual server that is <TT>execed</TT>, not by <TT>inetd</TT> itself.</P><P class="docText"><TT>inetd</TT> could read the datagram specifying the <TT>MSG_PEEK</TT> flag (<A class="docLink" HREF="0131411551_ch14lev1sec7.html#ch14lev1sec7">Section 14.7</A>), just to obtain the client's IP address and port, but leaving the datagram in place for the actual server to read.</P></TD></TR></TABLE></P><br>
<P class="docText"></P>

<a href="0131411551_22961534.html"><img src="FILES/pixel.gif" width="1" height="1" border="0"></a><ul></ul></td></tr></table>
<td></td>
<table width="100%" border="0" cellspacing="0" cellpadding="0">
<td class="tt1"><a href="NFO/lib.html">[ Team LiB ]</a></td><td valign="top" class="tt1" align="right">
          <a href="0131411551_app05lev1sec12.html"><img src="FILES/btn_prev.gif" width="62" height="15" border="0" align="absmiddle" alt="Previous Section"></a>
          <a href="0131411551_app05lev1sec14.html"><img src="FILES/btn_next.gif" width="41" height="15" border="0" align="absmiddle" alt="Next Section"></a>
</td></table>
</body></html>
